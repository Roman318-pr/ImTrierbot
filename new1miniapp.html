<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—ë Mini App</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º SDK Telegram [citation:5] -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
        }
        button {
            background-color: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            margin: 10px 0;
            cursor: pointer;
        }
        .card {
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>üéÆ –ú–æ—ë –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h1>

    <div class="card" id="user-info">
        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>

    <div class="card">
        <h3>–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h3>
        <button onclick="showJoke()">üòÇ –ü–æ–∫–∞–∑–∞—Ç—å —à—É—Ç–∫—É</button>
        <button onclick="sendToBot()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É</button>
        <button onclick="closeApp()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <div class="card" id="result" style="display: none;">
        <p id="result-text"></p>
    </div>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç WebApp [citation:5]
        const tg = window.Telegram.WebApp;

        // –°–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
        tg.ready();

        // –†–∞—Å—à–∏—Ä—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        tg.expand();

        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe?.user;

        if (user) {
            document.getElementById('user-info').innerHTML = `
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
                <p>üë§ –ò–º—è: ${user.first_name} ${user.last_name || ''}</p>
                <p>üÜî ID: ${user.id}</p>
                <p>üåê –Ø–∑—ã–∫: ${user.language_code || '–Ω–µ —É–∫–∞–∑–∞–Ω'}</p>
            `;
        } else {
            document.getElementById('user-info').innerHTML = `
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
                <p>–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)</p>
            `;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —à—É—Ç–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–∞—à–∏ –∞–Ω–µ–∫–¥–æ—Ç—ã)
        function showJoke() {
            const jokes = [
                "–°–∏—Å–∞–¥–º–∏–Ω —Å–ø–∏—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏? –ù–µ—Ç, –æ–Ω –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è.",
                "–ö—É–ø–∏–ª —É–º–Ω—ã–π —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫. –¢–µ–ø–µ—Ä—å –æ–Ω —Å–∞–º –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç –µ–¥—É...",
                "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—É—Ç–∞—é—Ç –•—ç–ª–ª–æ—É–∏–Ω –∏ –†–æ–∂–¥–µ—Å—Ç–≤–æ? –ü–æ—Ç–æ–º—É —á—Ç–æ 31 Oct = 25 Dec."
            ];
            const randomJoke = jokes[Math.floor(Math.random() * jokes.length)];

            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('result-text');
            resultText.textContent = randomJoke;
            resultDiv.style.display = 'block';
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–æ—Ç–∞
        function sendToBot() {
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('result-text');

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É [citation:1]
            tg.sendData(JSON.stringify({
                action: 'joke_requested',
                text: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–∏–ª —à—É—Ç–∫—É —á–µ—Ä–µ–∑ Mini App'
            }));

            resultText.textContent = '‚úÖ –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –±–æ—Ç—É!';
            resultDiv.style.display = 'block';
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function closeApp() {
            tg.close();
        }

        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram [citation:5]
        tg.MainButton.setText("–û—Ç–ø—Ä–∞–≤–∏—Ç—å —à—É—Ç–∫—É");
        tg.MainButton.onClick(() => {
            showJoke();
        });
        tg.MainButton.show();
    </script>
</body>
</html>