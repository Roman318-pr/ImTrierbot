<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Mini App</title>
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: #000000;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #ffffff;
            position: relative;
            padding-bottom: 90px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Å–µ—Ç–∫–æ–π –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
            flex: 1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .card {
            background-color: #1a1a1a;
            border-radius: 20px;
            padding: 16px;
            min-height: 160px;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #333333;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .card:active {
            transform: scale(0.98);
            border-color: #ffffff;
        }

        .card-badge {
            color: #888888;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .card-subtitle {
            color: #888888;
            font-size: 14px;
        }

        .card-value {
            font-size: 32px;
            font-weight: 700;
            margin-top: auto;
        }

        .trend-up {
            color: #4caf50;
        }

        .trend-down {
            color: #f44336;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –¥–≤—É–º—è –∫–Ω–æ–ø–∫–∞–º–∏ */
        .top-actions {
            padding: 16px;
            display: flex;
            gap: 12px;
            border-bottom: 1px solid #333333;
        }

        .btn {
            flex: 1;
            height: 52px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn:active {
            transform: scale(0.97);
        }

        .btn-yellow {
            background-color: #ffd700;
            color: #000000;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .btn-yellow:hover {
            background-color: #ffed4a;
        }

        .btn-blue {
            background-color: #2563eb;
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        .btn-blue:hover {
            background-color: #3b82f6;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-stats {
            padding: 16px;
            background: linear-gradient(145deg, #111111, #1a1a1a);
            margin: 0 16px 16px;
            border-radius: 20px;
            border: 1px solid #333333;
            display: flex;
            justify-content: space-between;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: #888888;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #ffd700;
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #111111;
            border-top: 1px solid #333333;
            display: flex;
            justify-content: space-around;
            padding: 12px 8px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .nav-item:active {
            background-color: #2a2a2a;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 12px;
            color: #888888; /* –°–µ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .nav-item.active .nav-label {
            color: #ffffff; /* –ë–µ–ª—ã–π –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ */
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: block;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #333333;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #ffd700;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888888;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
        }

        .modal-close:active {
            color: #ffffff;
        }

        .modal-content {
            color: #ffffff;
        }

        /* –†–∞–∑–Ω—ã–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .action-button {
            background-color: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 16px;
            padding: 20px 12px;
            color: #ffffff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .action-button:active {
            background-color: #2a2a2a;
            border-color: #ffd700;
            transform: scale(0.98);
        }

        .action-emoji {
            font-size: 32px;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */
        .progress-bar {
            background-color: #333333;
            height: 8px;
            border-radius: 4px;
            margin: 16px 0;
            overflow: hidden;
        }

        .progress-fill {
            background-color: #ffd700;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .glow {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
    </style>
</head>
<body>
    <!-- Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -->
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#000000');
        tg.setBackgroundColor('#000000');
    </script>

    <!-- –í–µ—Ä—Ö–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="top-actions">
        <button class="btn btn-yellow" id="addToPvpBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ –ü–≤–ü</button>
        <button class="btn btn-blue" id="tenTonBtn">‚ö° 10 —Ç–æ–Ω</button>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="user-stats">
        <div class="stat-item">
            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="stat-value" id="balance">2,500</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
            <div class="stat-value" id="level">42</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–†–µ–π—Ç–∏–Ω–≥</div>
            <div class="stat-value" id="rating">1,280</div>
        </div>
    </div>

    <!-- –°–µ—Ç–∫–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç) -->
    <div class="grid-container" id="mainContent">
        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav" id="bottomNav">
        <button class="nav-item" data-tab="pvp">
            <span class="nav-icon">‚öîÔ∏è</span>
            <span class="nav-label">–ü–≤–ü</span>
        </button>
        <button class="nav-item" data-tab="solo">
            <span class="nav-icon">üéÆ</span>
            <span class="nav-label">–°–æ–ª–æ</span>
        </button>
        <button class="nav-item" data-tab="draws">
            <span class="nav-icon">üé≤</span>
            <span class="nav-label">–†–æ–∑—ã–≥—Ä—ã—à–∏</span>
        </button>
        <button class="nav-item" data-tab="shop">
            <span class="nav-icon">üõí</span>
            <span class="nav-label">–ú–∞–≥–∞–∑–∏–Ω</span>
        </button>
        <button class="nav-item" data-tab="profile">
            <span class="nav-icon">üë§</span>
            <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ü–≤–ü -->
    <div class="modal" id="pvpModal">
        <div class="modal-header">
            <div class="modal-title">–ü–≤–ü –ê—Ä–µ–Ω–∞</div>
            <button class="modal-close" onclick="closeModal('pvpModal')">‚úï</button>
        </div>
        <div class="modal-content">
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞:</p>
            <div class="action-grid">
                <button class="action-button" onclick="startPvP('easy')">
                    <span class="action-emoji">ü•â</span>
                    –õ–µ–≥–∫–∏–π (x1.0)
                </button>
                <button class="action-button" onclick="startPvP('medium')">
                    <span class="action-emoji">ü•à</span>
                    –°—Ä–µ–¥–Ω–∏–π (x1.5)
                </button>
                <button class="action-button" onclick="startPvP('hard')">
                    <span class="action-emoji">ü•á</span>
                    –°–ª–æ–∂–Ω—ã–π (x2.0)
                </button>
                <button class="action-button" onclick="startPvP('extreme')">
                    <span class="action-emoji">üíÄ</span>
                    –≠–∫—Å—Ç—Ä–∏–º (x3.0)
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –°–æ–ª–æ -->
    <div class="modal" id="soloModal">
        <div class="modal-header">
            <div class="modal-title">–°–æ–ª–æ —Ä–µ–∂–∏–º</div>
            <button class="modal-close" onclick="closeModal('soloModal')">‚úï</button>
        </div>
        <div class="modal-content">
            <div class="progress-bar">
                <div class="progress-fill" id="soloProgress" style="width: 35%;"></div>
            </div>
            <p>–ü—Ä–æ–≥—Ä–µ—Å—Å: 35% –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é</p>
            <div class="action-grid">
                <button class="action-button" onclick="startSolo()">
                    <span class="action-emoji">‚ñ∂Ô∏è</span>
                    –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                </button>
                <button class="action-button" onclick="claimReward()">
                    <span class="action-emoji">üéÅ</span>
                    –ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –†–æ–∑—ã–≥—Ä—ã—à–µ–π -->
    <div class="modal" id="drawsModal">
        <div class="modal-header">
            <div class="modal-title">–†–æ–∑—ã–≥—Ä—ã—à–∏</div>
            <button class="modal-close" onclick="closeModal('drawsModal')">‚úï</button>
        </div>
        <div class="modal-content">
            <p>–î–æ—Å—Ç—É–ø–Ω–æ –±–∏–ª–µ—Ç–æ–≤: <span id="ticketCount">5</span></p>
            <div class="action-grid">
                <button class="action-button" onclick="buyTicket()">
                    <span class="action-emoji">üéüÔ∏è</span>
                    –ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç (100)
                </button>
                <button class="action-button" onclick="enterDraw()">
                    <span class="action-emoji">‚ú®</span>
                    –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ú–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="modal" id="shopModal">
        <div class="modal-header">
            <div class="modal-title">–ú–∞–≥–∞–∑–∏–Ω</div>
            <button class="modal-close" onclick="closeModal('shopModal')">‚úï</button>
        </div>
        <div class="modal-content">
            <div class="action-grid">
                <button class="action-button" onclick="buyItem('sword')">
                    <span class="action-emoji">‚öîÔ∏è</span>
                    –ú–µ—á (500)
                </button>
                <button class="action-button" onclick="buyItem('shield')">
                    <span class="action-emoji">üõ°Ô∏è</span>
                    –©–∏—Ç (400)
                </button>
                <button class="action-button" onclick="buyItem('potion')">
                    <span class="action-emoji">üß™</span>
                    –ó–µ–ª—å–µ (150)
                </button>
                <button class="action-button" onclick="buyItem('armor')">
                    <span class="action-emoji">üëï</span>
                    –ë—Ä–æ–Ω—è (800)
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ü—Ä–æ—Ñ–∏–ª—è -->
    <div class="modal" id="profileModal">
        <div class="modal-header">
            <div class="modal-title">–ü—Ä–æ—Ñ–∏–ª—å</div>
            <button class="modal-close" onclick="closeModal('profileModal')">‚úï</button>
        </div>
        <div class="modal-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 64px;">üë§</div>
                <h2 id="playerName">–ò–≥—Ä–æ–∫</h2>
            </div>
            <div class="stat-item" style="margin-bottom: 10px;">
                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–±–µ–¥</div>
                <div class="stat-value" style="color: #ffd700;" id="totalWins">127</div>
            </div>
            <div class="stat-item" style="margin-bottom: 10px;">
                <div class="stat-label">–í—Ä–µ–º—è –≤ –∏–≥—Ä–µ</div>
                <div class="stat-value" style="color: #ffd700;" id="playTime">42 —á–∞—Å–∞</div>
            </div>
            <button class="btn btn-yellow" style="width: 100%; margin-top: 20px;" onclick="logout()">
                –í—ã–π—Ç–∏
            </button>
        </div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let currentTab = 'pvp';
        let balance = 2500;
        let tickets = 5;
        let userData = {};

        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
        try {
            userData = tg.initDataUnsafe?.user || {};
            document.getElementById('playerName').textContent = userData.first_name || '–ò–≥—Ä–æ–∫';
        } catch (e) {
            console.log('Telegram data not available');
        }

        // –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫
        const tabContent = {
            pvp: [
                { badge: '–ê–ö–¢–ò–í–ù–´–ô', title: '–¢—É—Ä–Ω–∏—Ä 3x3', subtitle: '–ù–∞–≥—Ä–∞–¥–∞: 500', value: 'üî• 128 –∏–≥—Ä–æ–∫–æ–≤' },
                { badge: '–ù–û–í–´–ô', title: '–†–µ–π—Ç–∏–Ω–≥–æ–≤—ã–π', subtitle: '+150 –∑–∞ –ø–æ–±–µ–¥—É', value: 'üèÜ –†–∞–Ω–≥ 4' },
                { badge: '–≠–í–ï–ù–¢', title: '–ù–æ—á–Ω–æ–π –±–æ–π', subtitle: 'x2 –æ–ø—ã—Ç', value: 'üåô 2—á –æ—Å—Ç–∞–ª–æ—Å—å' },
                { badge: '–¢–†–ï–ù–ò–†–û–í–ö–ê', title: '–°–ø–∞—Ä—Ä–∏–Ω–≥', subtitle: '–ë–µ–∑ –ø–æ—Ç–µ—Ä—å', value: '‚ö° –î–æ—Å—Ç—É–ø–Ω–æ' }
            ],
            solo: [
                { badge: '–ö–ê–ú–ü–ê–ù–ò–Ø', title: '–ì–ª–∞–≤–∞ 5', subtitle: '–õ–µ—Å —Ç–µ–Ω–µ–π', value: 'üéØ 3/5 –∑–∞–¥–∞–Ω–∏–π' },
                { badge: '–í–´–ó–û–í', title: '–ë–µ–∑–¥–Ω–∞', subtitle: '–°–ª–æ–∂–Ω–æ—Å—Ç—å: 50', value: '‚è≥ 2 –ø–æ–ø—ã—Ç–∫–∏' },
                { badge: '–ï–ñ–ï–î–ù–ï–í–ù–û', title: '–ó–∞–¥–∞–Ω–∏—è –¥–Ω—è', subtitle: '+200 –æ–ø—ã—Ç–∞', value: '‚úÖ 2/3' },
                { badge: '–î–û–°–¢–ò–ñ–ï–ù–ò–Ø', title: '–ú–∞—Å—Ç–µ—Ä –∫–ª–∏–Ω–∫–∞', subtitle: '100 –ø–æ–±–µ–¥', value: 'üèÖ 67/100' }
            ],
            draws: [
                { badge: '–ë–ï–°–ü–õ–ê–¢–ù–û', title: '–ö–æ–ª–µ—Å–æ —É–¥–∞—á–∏', subtitle: '–ö–∞–∂–¥—ã–µ 4—á', value: `üéüÔ∏è ${tickets} –±–∏–ª–µ—Ç–æ–≤` },
                { badge: '–ü–†–ï–ú–ò–£–ú', title: '–ó–æ–ª–æ—Ç–æ–π —Å—É–Ω–¥—É–∫', subtitle: '–®–∞–Ω—Å 5%', value: 'üíé 500' },
                { badge: '–≠–í–ï–ù–¢', title: '–£—Ç—Ä–µ–Ω–Ω—è—è –ª–æ—Ç–µ—Ä–µ—è', subtitle: '–£—á–∞—Å—Ç–≤—É—é—Ç 200', value: 'üéÅ –î–∂–µ–∫–ø–æ—Ç' },
                { badge: '–¢–£–†–ù–ò–†', title: '–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤', subtitle: '–ü—Ä–∏–∑ 5000', value: 'üèÜ –¢–æ–ø 100' }
            ],
            shop: [
                { badge: '–°–ö–ò–î–ö–ê', title: '–ù–∞–±–æ—Ä –Ω–æ–≤–∏—á–∫–∞', subtitle: '-30%', value: 'üí∞ 299' },
                { badge: '–ü–†–ï–ú–ò–£–ú', title: '–ë–æ–µ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫', subtitle: '60 —É—Ä–æ–≤–Ω–µ–π', value: 'üíé 1200' },
                { badge: '–û–ì–†–ê–ù–ò–ß–ï–ù–û', title: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Å–∫–∏–Ω', subtitle: '–û—Å—Ç–∞–ª–æ—Å—å 3', value: '‚ú® 2500' },
                { badge: 'VIP', title: '–ö—Ä–∏—Å—Ç–∞–ª–ª—ã', subtitle: 'x2 –±–æ–Ω—É—Å', value: 'üíé 1000' }
            ],
            profile: [
                { badge: '–°–¢–ê–¢–ò–°–¢–ò–ö–ê', title: '–í—Å–µ–≥–æ –∏–≥—Ä', subtitle: '–ü–æ–±–µ–¥—ã/–ü–æ—Ä–∞–∂–µ–Ω–∏—è', value: '324' },
                { badge: '–î–û–°–¢–ò–ñ–ï–ù–ò–Ø', title: '–°–µ—Ä–∏—è –ø–æ–±–µ–¥', subtitle: '–ú–∞–∫—Å–∏–º—É–º', value: 'üî• 12' },
                { badge: '–ò–ù–í–ï–ù–¢–ê–†–¨', title: '–ü—Ä–µ–¥–º–µ—Ç–æ–≤', subtitle: '–≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–æ', value: '15/24' },
                { badge: '–ö–õ–ê–ù', title: '–•—Ä–∞–Ω–∏—Ç–µ–ª–∏', subtitle: '–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ 28', value: '‚öîÔ∏è –†–∞–Ω–≥ 3' }
            ]
        };

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function updateGrid(tab) {
            const grid = document.getElementById('mainContent');
            grid.innerHTML = '';
            
            tabContent[tab].forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => handleCardClick(item);
                
                card.innerHTML = `
                    <div class="card-badge">${item.badge}</div>
                    <div class="card-title">${item.title}</div>
                    <div class="card-subtitle">${item.subtitle}</div>
                    <div class="card-value">${item.value}</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º
        function handleCardClick(item) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram
            tg.showAlert(`–í—ã –≤—ã–±—Ä–∞–ª–∏: ${item.title}\n${item.subtitle}`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ —É–∂–µ –µ—Å—Ç—å –≤ CSS —á–µ—Ä–µ–∑ :active
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.nav-item').forEach(button => {
            button.addEventListener('click', (e) => {
                const tab = button.dataset.tab;
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–µ
                button.classList.add('active');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                updateGrid(tab);
                currentTab = tab;
                
                // –í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
                if (tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('light');
                }
            });
        });

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É (–ü–≤–ü)
        document.querySelector('[data-tab="pvp"]').classList.add('active');
        updateGrid('pvp');

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –≤ –ü–≤–ü"
        document.getElementById('addToPvpBtn').addEventListener('click', () => {
            openModal('pvpModal');
            
            // –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è
            event.target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                event.target.style.transform = '';
            }, 100);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "10 —Ç–æ–Ω"
        document.getElementById('tenTonBtn').addEventListener('click', () => {
            tg.showPopup({
                title: '10 —Ç–æ–Ω–Ω —ç–Ω–µ—Ä–≥–∏–∏',
                message: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –±–æ–Ω—É—Å?',
                buttons: [
                    {id: 'confirm', type: 'default', text: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å'},
                    {id: 'cancel', type: 'destructive', text: '–û—Ç–º–µ–Ω–∞'}
                ]
            }, (buttonId) => {
                if (buttonId === 'confirm') {
                    balance += 1000;
                    document.getElementById('balance').textContent = balance.toLocaleString();
                    tg.showAlert('‚úÖ +1000 —ç–Ω–µ—Ä–≥–∏–∏ –ø–æ–ª—É—á–µ–Ω–æ!');
                }
            });
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            event.target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                event.target.style.transform = '';
            }, 100);
        });

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ü–≤–ü –º–æ–¥–∞–ª–∫–∏
        function startPvP(difficulty) {
            const multipliers = {easy: 1, medium: 1.5, hard: 2, extreme: 3};
            const reward = Math.floor(100 * multipliers[difficulty]);
            
            tg.showPopup({
                title: '–ë–æ–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è!',
                message: `–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –ø–æ–±–µ–¥—É: ${reward}`,
                buttons: [{id: 'ok', type: 'default', text: '–í –±–æ–π!'}]
            });
            
            closeModal('pvpModal');
        }

        // –°–æ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏
        function startSolo() {
            const progress = document.getElementById('soloProgress');
            const currentWidth = parseInt(progress.style.width) || 35;
            const newWidth = Math.min(currentWidth + 15, 100);
            progress.style.width = newWidth + '%';
            
            if (newWidth === 100) {
                tg.showAlert('üéâ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω!');
                progress.style.width = '0%';
            }
            
            closeModal('soloModal');
        }

        function claimReward() {
            balance += 200;
            document.getElementById('balance').textContent = balance.toLocaleString();
            tg.showAlert('üéÅ +200 –ø–æ–ª—É—á–µ–Ω–æ!');
            closeModal('soloModal');
        }

        // –†–æ–∑—ã–≥—Ä—ã—à–∏
        function buyTicket() {
            if (balance >= 100) {
                balance -= 100;
                tickets++;
                document.getElementById('balance').textContent = balance.toLocaleString();
                document.getElementById('ticketCount').textContent = tickets;
                tg.showAlert('üéüÔ∏è –ë–∏–ª–µ—Ç –∫—É–ø–ª–µ–Ω!');
            } else {
                tg.showAlert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
            }
        }

        function enterDraw() {
            if (tickets > 0) {
                tickets--;
                document.getElementById('ticketCount').textContent = tickets;
                
                // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à
                const won = Math.random() > 0.7 ? Math.floor(Math.random() * 500) + 100 : 0;
                if (won > 0) {
                    balance += won;
                    document.getElementById('balance').textContent = balance.toLocaleString();
                    tg.showAlert(`üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${won}!`);
                } else {
                    tg.showAlert('üò¢ –ü–æ–≤–µ–∑–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑');
                }
            } else {
                tg.showAlert('‚ùå –ù–µ—Ç –±–∏–ª–µ—Ç–æ–≤');
            }
            closeModal('drawsModal');
        }

        // –ú–∞–≥–∞–∑–∏–Ω
        function buyItem(item) {
            const prices = {sword: 500, shield: 400, potion: 150, armor: 800};
            const price = prices[item];
            
            if (balance >= price) {
                balance -= price;
                document.getElementById('balance').textContent = balance.toLocaleString();
                tg.showAlert(`‚úÖ –ö—É–ø–ª–µ–Ω–æ! –û—Å—Ç–∞—Ç–æ–∫: ${balance}`);
            } else {
                tg.showAlert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
            }
            closeModal('shopModal');
        }

        // –ü—Ä–æ—Ñ–∏–ª—å
        function logout() {
            tg.showConfirm('–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?', (confirmed) => {
                if (confirmed) {
                    tg.close();
                }
            });
            closeModal('profileModal');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∫–Ω–æ–ø–æ–∫
        tg.MainButton.setText('–ú–µ–Ω—é');
        tg.MainButton.show();

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('beforeunload', () => {
            tg.sendData(JSON.stringify({
                action: 'app_closed',
                tab: currentTab,
                balance: balance
            }));
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –≤–Ω–µ (–¥–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ–º –º–æ–¥–∞–ª–∫–∞–º)
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });

        console.log('Mini App –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
    </script>
</body>
</html>
