<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Duel ¬∑ –°—Ç–∞–≤–∫–∏</title>
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: #000000;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #ffffff;
            position: relative;
            padding-bottom: 90px;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –¥–≤—É–º—è –∫–Ω–æ–ø–∫–∞–º–∏ */
        .top-actions {
            padding: 16px;
            display: flex;
            gap: 12px;
            border-bottom: 1px solid #333333;
            background-color: #000000;
            z-index: 5;
        }

        .btn {
            flex: 1;
            height: 52px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn:active {
            transform: scale(0.97);
        }

        .btn-yellow {
            background-color: #ffd700;
            color: #000000;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .btn-blue {
            background-color: #2563eb;
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫—Ä—É–≥–∞ (–Ω–∞–¥ –∫–Ω–æ–ø–∫–∞–º–∏) */
        .wheel-section {
            padding: 20px 16px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(to bottom, #000000, #0a0a0a);
            border-bottom: 1px solid #333333;
        }

        .wheel-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –ë–æ–ª—å—à–æ–π –∫—Ä—É–≥ (—Ä—É–ª–µ—Ç–∫–∞) */
        .big-wheel {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                #ff4444 0deg,
                #ff4444 0deg,
                #44ff44 0deg,
                #44ff44 360deg
            );
            position: relative;
            box-shadow: 0 0 30px rgba(255, 68, 68, 0.2);
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.15, 1);
            transform: rotate(0deg);
            will-change: transform;
            border: 2px solid #333333;
        }

        /* –ú–∞–ª–µ–Ω—å–∫–∏–π –∫—Ä—É–≥ (—Ç–∞–π–º–µ—Ä) */
        .small-timer {
            position: absolute;
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: #111111;
            border: 3px solid #333333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(4px);
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .timer-value {
            font-size: 32px;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            line-height: 1;
        }

        .timer-label {
            font-size: 10px;
            color: #888888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞–≤–∫–∞—Ö */
        .bets-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 280px;
            margin-top: 15px;
            background: #111111;
            border-radius: 30px;
            padding: 8px 16px;
            border: 1px solid #333333;
        }

        .bet-player {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .bet-player.red .bet-value {
            color: #ff4444;
        }

        .bet-player.green .bet-value {
            color: #44ff44;
        }

        .bet-label {
            font-size: 12px;
            color: #888888;
        }

        .bet-value {
            font-size: 18px;
            font-weight: 700;
        }

        .bet-percent {
            font-size: 12px;
            color: #888888;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ */
        .bet-panel {
            padding: 16px;
            background: #0a0a0a;
            border-top: 1px solid #333333;
            border-bottom: 1px solid #333333;
        }

        .bet-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 12px;
        }

        .bet-input {
            flex: 1;
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 20px;
            padding: 12px 16px;
            color: #ffffff;
            font-size: 16px;
            outline: none;
        }

        .bet-input:focus {
            border-color: #ffd700;
        }

        .bet-buttons {
            display: flex;
            gap: 8px;
        }

        .bet-amount-btn {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 20px;
            padding: 8px 16px;
            color: #ffffff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bet-amount-btn:active {
            background: #2a2a2a;
            border-color: #ffd700;
        }

        .bet-amount-btn.active {
            background: #ffd700;
            color: #000000;
            border-color: #ffd700;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .action-btn {
            flex: 1;
            padding: 14px;
            border-radius: 30px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn:active {
            transform: scale(0.97);
        }

        .action-btn-red {
            background: #ff4444;
            color: white;
            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);
        }

        .action-btn-green {
            background: #44ff44;
            color: black;
            box-shadow: 0 4px 15px rgba(68, 255, 68, 0.3);
        }

        .action-btn-yellow {
            background: #ffd700;
            color: black;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-stats {
            padding: 16px;
            background: linear-gradient(145deg, #111111, #1a1a1a);
            margin: 0 16px 16px;
            border-radius: 20px;
            border: 1px solid #333333;
            display: flex;
            justify-content: space-between;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: #888888;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #ffd700;
        }

        /* –°–µ—Ç–∫–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
            flex: 1;
        }

        .card {
            background-color: #1a1a1a;
            border-radius: 20px;
            padding: 16px;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            border: 1px solid #333333;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .card:active {
            transform: scale(0.98);
            border-color: #ffffff;
        }

        .card-badge {
            color: #888888;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .card-subtitle {
            color: #888888;
            font-size: 12px;
        }

        .card-value {
            font-size: 24px;
            font-weight: 700;
            margin-top: auto;
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #111111;
            border-top: 1px solid #333333;
            display: flex;
            justify-content: space-around;
            padding: 12px 8px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .nav-item:active {
            background-color: #2a2a2a;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 12px;
            color: #888888;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .nav-item.active .nav-label {
            color: #ffffff;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –≤ –≤–∞—à–µ–º –ø—Ä–æ—à–ª–æ–º –∫–æ–¥–µ) */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: block;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #333333;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #ffd700;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888888;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
        }

        .modal-close:active {
            color: #ffffff;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .action-button {
            background-color: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 16px;
            padding: 20px 12px;
            color: #ffffff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .action-button:active {
            background-color: #2a2a2a;
            border-color: #ffd700;
            transform: scale(0.98);
        }

        .action-emoji {
            font-size: 32px;
        }
    </style>
</head>
<body>
    <!-- Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -->
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#000000');
        tg.setBackgroundColor('#000000');
    </script>

    <!-- –í–µ—Ä—Ö–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è (–ñ–µ–ª—Ç–∞—è –∏ –°–∏–Ω—è—è) -->
    <div class="top-actions">
        <button class="btn btn-yellow" id="addToPvpBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ –ü–≤–ü</button>
        <button class="btn btn-blue" id="tenTonBtn">‚ö° 10 —Ç–æ–Ω</button>
    </div>

    <!-- –°–µ–∫—Ü–∏—è —Å –∫—Ä—É–≥–æ–º (–ù–ê–î –∫–Ω–æ–ø–∫–∞–º–∏, –Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ –Ω–∏—Ö –≤ –ø–æ—Ç–æ–∫–µ) -->
    <div class="wheel-section">
        <div class="wheel-container">
            <div class="big-wheel" id="bigWheel"></div>
            <div class="small-timer">
                <span class="timer-value" id="timerDisplay">15</span>
                <span class="timer-label">—Å–µ–∫—É–Ω–¥</span>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–∏—Ö —Å—Ç–∞–≤–∫–∞—Ö -->
        <div class="bets-info">
            <div class="bet-player red" id="redBetInfo">
                <span class="bet-label">–ö—Ä–∞—Å–Ω—ã–π</span>
                <span class="bet-value" id="redBetAmount">0</span>
                <span class="bet-percent" id="redBetPercent">0%</span>
            </div>
            <div class="bet-player green" id="greenBetInfo">
                <span class="bet-label">–ó–µ–ª–µ–Ω—ã–π</span>
                <span class="bet-value" id="greenBetAmount">0</span>
                <span class="bet-percent" id="greenBetPercent">0%</span>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –¥–ª—è —Å—Ç–∞–≤–æ–∫ -->
        <div class="bet-panel">
            <div class="bet-input-group">
                <input type="number" class="bet-input" id="betAmount" placeholder="–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏" min="1" value="10">
                <div class="bet-buttons">
                    <button class="bet-amount-btn" data-amount="10">10</button>
                    <button class="bet-amount-btn" data-amount="50">50</button>
                    <button class="bet-amount-btn" data-amount="100">100</button>
                </div>
            </div>
            <div class="action-buttons">
                <button class="action-btn action-btn-red" id="betRedBtn">üî¥ –°—Ç–∞–≤–∫–∞ –Ω–∞ –∫—Ä–∞—Å–Ω—ã–π</button>
                <button class="action-btn action-btn-green" id="betGreenBtn">üü¢ –°—Ç–∞–≤–∫–∞ –Ω–∞ –∑–µ–ª–µ–Ω—ã–π</button>
            </div>
            <button class="action-btn action-btn-yellow" id="resetBetBtn" style="margin-top: 10px;">üîÑ –°–±—Ä–æ—Å —Å—Ç–∞–≤–æ–∫</button>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="user-stats">
        <div class="stat-item">
            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="stat-value" id="balance">2,500</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
            <div class="stat-value" id="level">42</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–†–µ–π—Ç–∏–Ω–≥</div>
            <div class="stat-value" id="rating">1,280</div>
        </div>
    </div>

    <!-- –°–µ—Ç–∫–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ -->
    <div class="grid-container" id="mainContent"></div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav" id="bottomNav">
        <button class="nav-item" data-tab="pvp">
            <span class="nav-icon">‚öîÔ∏è</span>
            <span class="nav-label">–ü–≤–ü</span>
        </button>
        <button class="nav-item" data-tab="solo">
            <span class="nav-icon">üéÆ</span>
            <span class="nav-label">–°–æ–ª–æ</span>
        </button>
        <button class="nav-item" data-tab="draws">
            <span class="nav-icon">üé≤</span>
            <span class="nav-label">–†–æ–∑—ã–≥—Ä—ã—à–∏</span>
        </button>
        <button class="nav-item" data-tab="shop">
            <span class="nav-icon">üõí</span>
            <span class="nav-label">–ú–∞–≥–∞–∑–∏–Ω</span>
        </button>
        <button class="nav-item" data-tab="profile">
            <span class="nav-icon">üë§</span>
            <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (—Å–æ–∫—Ä–∞—Ç–∏–ª –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏, –Ω–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç) -->
    <div class="modal" id="resultModal">
        <div class="modal-header">
            <div class="modal-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
            <button class="modal-close" onclick="closeModal('resultModal')">‚úï</button>
        </div>
        <div class="modal-content" id="resultContent"></div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let balance = 2500;
        let currentTab = 'pvp';
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–∞–≤–æ–∫
        let redBet = 0;
        let greenBet = 0;
        let totalBets = 0;
        let timerSeconds = 15;
        let timerInterval = null;
        let wheelSpinning = false;
        let currentRotation = 0;
        
        // –¶–≤–µ—Ç–∞ –∏–≥—Ä–æ–∫–æ–≤ (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏)
        let currentWinner = null;

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const bigWheel = document.getElementById('bigWheel');
        const timerDisplay = document.getElementById('timerDisplay');
        const redBetAmount = document.getElementById('redBetAmount');
        const greenBetAmount = document.getElementById('greenBetAmount');
        const redBetPercent = document.getElementById('redBetPercent');
        const greenBetPercent = document.getElementById('greenBetPercent');
        const betInput = document.getElementById('betAmount');
        const balanceDisplay = document.getElementById('balance');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –¥–∞–Ω–Ω—ã—Ö
        const userData = tg.initDataUnsafe?.user || {};
        
        // –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
        const tabContent = {
            pvp: [
                { badge: '–ê–ö–¢–ò–í–ù–´–ô', title: '–¢—É—Ä–Ω–∏—Ä 3x3', subtitle: '–ù–∞–≥—Ä–∞–¥–∞: 500', value: 'üî• 128 –∏–≥—Ä–æ–∫–æ–≤' },
                { badge: '–î–£–≠–õ–¨', title: '–°—Ç–∞–≤–∫–∏ –Ω–∞ –∫—Ä—É–≥–µ', subtitle: '–£–¥–≤–æ–µ–Ω–∏–µ', value: '‚ö° –ê–∫—Ç–∏–≤–Ω–æ' }
            ],
            solo: [
                { badge: '–ö–ê–ú–ü–ê–ù–ò–Ø', title: '–ì–ª–∞–≤–∞ 5', subtitle: '–õ–µ—Å —Ç–µ–Ω–µ–π', value: 'üéØ 3/5 –∑–∞–¥–∞–Ω–∏–π' },
                { badge: '–í–´–ó–û–í', title: '–ë–µ–∑–¥–Ω–∞', subtitle: '–°–ª–æ–∂–Ω–æ—Å—Ç—å: 50', value: '‚è≥ 2 –ø–æ–ø—ã—Ç–∫–∏' }
            ],
            draws: [
                { badge: '–ë–ï–°–ü–õ–ê–¢–ù–û', title: '–ö–æ–ª–µ—Å–æ —É–¥–∞—á–∏', subtitle: '–ö–∞–∂–¥—ã–µ 4—á', value: 'üéüÔ∏è 5 –±–∏–ª–µ—Ç–æ–≤' }
            ],
            shop: [
                { badge: '–°–ö–ò–î–ö–ê', title: '–ù–∞–±–æ—Ä –Ω–æ–≤–∏—á–∫–∞', subtitle: '-30%', value: 'üí∞ 299' }
            ],
            profile: [
                { badge: '–°–¢–ê–¢–ò–°–¢–ò–ö–ê', title: '–í—Å–µ–≥–æ –∏–≥—Ä', subtitle: '–ü–æ–±–µ–¥—ã/–ü–æ—Ä–∞–∂–µ–Ω–∏—è', value: '324' }
            ]
        };

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—Ä—É–≥–∞ (–ø—Ä–æ—Ü–µ–Ω—Ç—ã)
        function updateWheel() {
            totalBets = redBet + greenBet;
            
            if (totalBets === 0) {
                // –ï—Å–ª–∏ —Å—Ç–∞–≤–æ–∫ –Ω–µ—Ç - —Å–µ—Ä—ã–π –∫—Ä—É–≥
                bigWheel.style.background = 'conic-gradient(#333333 0deg, #333333 360deg)';
                redBetAmount.textContent = '0';
                greenBetAmount.textContent = '0';
                redBetPercent.textContent = '0%';
                greenBetPercent.textContent = '0%';
                return;
            }

            const redPercent = (redBet / totalBets) * 100;
            const greenPercent = (greenBet / totalBets) * 100;
            
            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≤ –≥—Ä–∞–¥—É—Å—ã (1% = 3.6 –≥—Ä–∞–¥—É—Å–∞)
            const redDegrees = redPercent * 3.6;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –∫—Ä—É–≥–∞
            bigWheel.style.background = `conic-gradient(
                #ff4444 0deg,
                #ff4444 ${redDegrees}deg,
                #44ff44 ${redDegrees}deg,
                #44ff44 360deg
            )`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            redBetAmount.textContent = redBet;
            greenBetAmount.textContent = greenBet;
            redBetPercent.textContent = `${Math.round(redPercent)}%`;
            greenBetPercent.textContent = `${Math.round(greenPercent)}%`;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function updateBalance(amount) {
            balance += amount;
            balanceDisplay.textContent = balance.toLocaleString();
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            if (wheelSpinning) return;
            
            timerSeconds = 15;
            timerDisplay.textContent = timerSeconds;
            
            timerInterval = setInterval(() => {
                timerSeconds--;
                timerDisplay.textContent = timerSeconds;
                
                // –ú–∏–≥–∞–Ω–∏–µ –∫—Ä–∞—Å–Ω—ã–º –ø—Ä–∏ –æ—Å—Ç–∞—Ç–∫–µ 3 —Å–µ–∫—É–Ω–¥—ã
                if (timerSeconds <= 3) {
                    timerDisplay.style.color = '#ff4444';
                } else {
                    timerDisplay.style.color = '#ffd700';
                }
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    spinWheel();
                }
            }, 1000);
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–ª–µ—Å–∞
        function spinWheel() {
            if (totalBets === 0) {
                // –ï—Å–ª–∏ —Å—Ç–∞–≤–æ–∫ –Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                startTimer();
                return;
            }
            
            wheelSpinning = true;
            
            // –†–∞–Ω–¥–æ–º–Ω—ã–π —É–≥–æ–ª –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–º–∏–Ω–∏–º—É–º 5 –æ–±–æ—Ä–æ—Ç–æ–≤ = 1800 –≥—Ä–∞–¥—É—Å–æ–≤)
            const spins = 1800 + Math.random() * 720; // 5-7 –æ–±–æ—Ä–æ—Ç–æ–≤
            const finalAngle = spins;
            
            currentRotation += finalAngle;
            bigWheel.style.transform = `rotate(${currentRotation}deg)`;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
            setTimeout(() => {
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —É–≥–æ–ª –¥–æ 0-360
                const normalizedAngle = (currentRotation % 360 + 360) % 360;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω–∞ –∫–∞–∫–æ–π —Ü–≤–µ—Ç –ø–æ–ø–∞–ª–∞ —Å—Ç—Ä–µ–ª–∫–∞ (0 –≥—Ä–∞–¥—É—Å–æ–≤ - –≤–µ—Ä—Ö)
                // –ö—Ä–∞—Å–Ω—ã–π –∑–∞–Ω–∏–º–∞–µ—Ç (redBet/totalBets)*360 –≥—Ä–∞–¥—É—Å–æ–≤ –æ—Ç 0
                const redDegrees = (redBet / totalBets) * 360;
                
                let winner = null;
                let winAmount = 0;
                
                if (normalizedAngle < redDegrees) {
                    winner = 'red';
                    winAmount = redBet * 2; // –£–¥–≤–æ–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
                    currentWinner = '–ö—Ä–∞—Å–Ω—ã–π';
                } else {
                    winner = 'green';
                    winAmount = greenBet * 2;
                    currentWinner = '–ó–µ–ª–µ–Ω—ã–π';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                showResult(winner, winAmount);
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞–≤–∫–∏ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    redBet = 0;
                    greenBet = 0;
                    updateWheel();
                    wheelSpinning = false;
                    startTimer();
                }, 3000);
                
            }, 3000); // –ñ–¥–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        function showResult(winner, amount) {
            const resultContent = document.getElementById('resultContent');
            resultContent.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">${winner === 'red' ? 'üî¥' : 'üü¢'}</div>
                    <h2>–ü–æ–±–µ–¥–∏–ª ${winner === 'red' ? '–ö—Ä–∞—Å–Ω—ã–π' : '–ó–µ–ª–µ–Ω—ã–π'}!</h2>
                    <p style="font-size: 24px; color: #ffd700; margin: 20px 0;">–í—ã–∏–≥—Ä—ã—à: ${amount}</p>
                    <button class="btn btn-yellow" onclick="closeModal('resultModal')" style="width: 100%;">–û–∫</button>
                </div>
            `;
            
            // –ï—Å–ª–∏ —ç—Ç–æ –Ω–∞—à –±–æ—Ç, –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            tg.sendData(JSON.stringify({
                action: 'duel_result',
                winner: winner,
                amount: amount
            }));
            
            openModal('resultModal');
        }

        // –°—Ç–∞–≤–∫–∞ –Ω–∞ –∫—Ä–∞—Å–Ω—ã–π
        document.getElementById('betRedBtn').addEventListener('click', () => {
            if (wheelSpinning) {
                tg.showAlert('–ö–æ–ª–µ—Å–æ –≤—Ä–∞—â–∞–µ—Ç—Å—è, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...');
                return;
            }
            
            const amount = parseInt(betInput.value);
            if (isNaN(amount) || amount <= 0) {
                tg.showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É');
                return;
            }
            
            if (amount > balance) {
                tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                return;
            }
            
            // –°–Ω–∏–º–∞–µ–º –±–∞–ª–∞–Ω—Å
            updateBalance(-amount);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞–≤–∫—É
            redBet += amount;
            updateWheel();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞—É–Ω–¥–µ, –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            if (totalBets === amount && !timerInterval) {
                startTimer();
            }
            
            tg.HapticFeedback?.impactOccurred('medium');
        });

        // –°—Ç–∞–≤–∫–∞ –Ω–∞ –∑–µ–ª–µ–Ω—ã–π
        document.getElementById('betGreenBtn').addEventListener('click', () => {
            if (wheelSpinning) {
                tg.showAlert('–ö–æ–ª–µ—Å–æ –≤—Ä–∞—â–∞–µ—Ç—Å—è, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...');
                return;
            }
            
            const amount = parseInt(betInput.value);
            if (isNaN(amount) || amount <= 0) {
                tg.showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É');
                return;
            }
            
            if (amount > balance) {
                tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                return;
            }
            
            updateBalance(-amount);
            greenBet += amount;
            updateWheel();
            
            if (totalBets === amount && !timerInterval) {
                startTimer();
            }
            
            tg.HapticFeedback?.impactOccurred('medium');
        });

        // –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–π —Å—Ç–∞–≤–∫–∏
        document.querySelectorAll('.bet-amount-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const amount = e.target.dataset.amount;
                betInput.value = amount;
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
                document.querySelectorAll('.bet-amount-btn').forEach(b => {
                    b.classList.remove('active');
                });
                e.target.classList.add('active');
            });
        });

        // –°–±—Ä–æ—Å —Å—Ç–∞–≤–æ–∫
        document.getElementById('resetBetBtn').addEventListener('click', () => {
            if (wheelSpinning) {
                tg.showAlert('–ö–æ–ª–µ—Å–æ –≤—Ä–∞—â–∞–µ—Ç—Å—è, –Ω–µ–ª—å–∑—è —Å–±—Ä–æ—Å–∏—Ç—å');
                return;
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–Ω—å–≥–∏
            updateBalance(redBet + greenBet);
            
            redBet = 0;
            greenBet = 0;
            updateWheel();
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                timerSeconds = 15;
                timerDisplay.textContent = '15';
                timerDisplay.style.color = '#ffd700';
            }
        });

        // –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –≤ –ü–≤–ü"
        document.getElementById('addToPvpBtn').addEventListener('click', () => {
            tg.showPopup({
                title: '–ü–≤–ü –î—É—ç–ª—å',
                message: '–ù–∞—á–∞—Ç—å –¥—É—ç–ª—å –Ω–∞ —Å—Ç–∞–≤–∫–∞—Ö?',
                buttons: [
                    {id: 'start', type: 'default', text: '–ù–∞—á–∞—Ç—å'},
                    {id: 'cancel', type: 'destructive', text: '–û—Ç–º–µ–Ω–∞'}
                ]
            }, (buttonId) => {
                if (buttonId === 'start') {
                    redBet = 0;
                    greenBet = 0;
                    updateWheel();
                    startTimer();
                }
            });
        });

        // –ö–Ω–æ–ø–∫–∞ "10 —Ç–æ–Ω"
        document.getElementById('tenTonBtn').addEventListener('click', () => {
            updateBalance(1000);
            tg.showAlert('‚úÖ +1000 –ø–æ–ª—É—á–µ–Ω–æ!');
        });

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –º–æ–¥–∞–ª–æ–∫
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.nav-item').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                button.classList.add('active');
                
                const tab = button.dataset.tab;
                const grid = document.getElementById('mainContent');
                grid.innerHTML = '';
                
                tabContent[tab].forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="card-badge">${item.badge}</div>
                        <div class="card-title">${item.title}</div>
                        <div class="card-subtitle">${item.subtitle}</div>
                        <div class="card-value">${item.value}</div>
                    `;
                    grid.appendChild(card);
                });
            });
        });

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
        document.querySelector('[data-tab="pvp"]').classList.add('active');
        document.querySelector('[data-tab="pvp"]').click();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä—É–≥–∞
        updateWheel();

        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –¥–ª—è –º–æ–¥–∞–ª–æ–∫
        window.closeModal = closeModal;
        window.openModal = openModal;
    </script>
</body>
</html>
