<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rolls ¬∑ PvP –†—É–ª–µ—Ç–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            padding: 16px 12px 90px;
            background: linear-gradient(145deg, #0a0a0a 0%, #1a1a1a 100%);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-stats {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            border: 1px solid #333333;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: #888888;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 22px;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        /* –°–µ–∫—Ü–∏—è —Ä—É–ª–µ—Ç–∫–∏ */
        .roulette-section {
            background: #111111;
            border-radius: 40px;
            padding: 24px 16px;
            margin-bottom: 20px;
            border: 1px solid #333333;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.7);
        }

        .wheel-container {
            position: relative;
            width: 260px;
            height: 260px;
            margin: 0 auto 25px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–µ –∫–æ–ª–µ—Å–æ */
        .wheel {
            width: 240px;
            height: 240px;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                #ff4444 0deg,
                #ff4444 120deg,
                #44ff44 120deg,
                #44ff44 240deg,
                #4444ff 240deg,
                #4444ff 360deg
            );
            position: relative;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.2);
            transition: transform 4s cubic-bezier(0.25, 0.1, 0.15, 1);
            transform: rotate(0deg);
            will-change: transform;
            border: 3px solid #333;
        }

        /* –°—Ç—Ä–µ–ª–∫–∞-—É–∫–∞–∑–∞—Ç–µ–ª—å */
        .arrow {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ffd700;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5));
            z-index: 20;
        }

        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ —Å —Ç–∞–π–º–µ—Ä–æ–º */
        .center-timer {
            position: absolute;
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: #1a1a1a;
            border: 3px solid #ffd700;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 15;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            backdrop-filter: blur(4px);
        }

        .timer-value {
            font-size: 36px;
            font-weight: 800;
            color: #ffd700;
            line-height: 1;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        }

        .timer-label {
            font-size: 10px;
            color: #cccccc;
            letter-spacing: 1px;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—É–Ω–¥–µ */
        .round-info {
            display: flex;
            justify-content: space-between;
            background: #1e1e1e;
            border-radius: 50px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }

        .players-count {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .players-icon {
            font-size: 24px;
        }

        .players-text {
            font-size: 14px;
            color: #aaa;
        }

        .pool-amount {
            font-size: 22px;
            font-weight: 700;
            color: #ffd700;
        }

        /* –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ä–∞—É–Ω–¥–µ */
        .players-list {
            background: #1a1a1a;
            border-radius: 30px;
            padding: 16px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }

        .players-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .player-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: #252525;
            border-radius: 20px;
            margin-bottom: 8px;
            border-left: 4px solid #ffd700;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .player-name {
            font-weight: 500;
        }

        .player-bet {
            font-size: 18px;
            font-weight: 700;
            color: #ffd700;
        }

        .win-chance {
            font-size: 14px;
            color: #4caf50;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ */
        .bet-panel {
            background: #1e1e1e;
            border-radius: 40px;
            padding: 20px;
            border: 1px solid #333;
        }

        .gifts-selector {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0 20px;
            scrollbar-width: none;
        }

        .gift-card {
            min-width: 90px;
            background: #2a2a2a;
            border-radius: 25px;
            padding: 15px 8px;
            text-align: center;
            border: 2px solid #444;
            transition: all 0.2s;
            cursor: pointer;
        }

        .gift-card.selected {
            border-color: #ffd700;
            background: #333;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .gift-emoji {
            font-size: 36px;
            margin-bottom: 5px;
        }

        .gift-value {
            font-size: 18px;
            font-weight: 700;
            color: #ffd700;
        }

        .gift-label {
            font-size: 12px;
            color: #aaa;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 16px;
            border-radius: 40px;
            font-weight: 700;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:active {
            transform: scale(0.97);
        }

        .btn-primary {
            background: #ffd700;
            color: #000;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-secondary {
            background: #2a2a2a;
            color: #fff;
            border: 1px solid #444;
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #111111;
            border-top: 1px solid #333;
            display: flex;
            justify-content: space-around;
            padding: 12px 8px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 20px;
            color: #888;
            transition: all 0.2s;
        }

        .nav-item.active {
            color: #ffd700;
        }

        .nav-item.active .nav-label {
            color: #ffd700;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 11px;
            color: #888;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            padding: 20px;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            border-radius: 40px;
            padding: 30px;
            max-width: 320px;
            width: 100%;
            border: 1px solid #ffd700;
            text-align: center;
        }

        .winner-emoji {
            font-size: 72px;
            margin-bottom: 20px;
        }

        .winner-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .winner-prize {
            font-size: 24px;
            color: #ffd700;
            margin-bottom: 25px;
        }

        .modal-btn {
            background: #ffd700;
            color: black;
            border: none;
            padding: 16px 30px;
            border-radius: 40px;
            font-weight: 700;
            width: 100%;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.setHeaderColor('#0a0a0a');
        tg.setBackgroundColor('#0a0a0a');
    </script>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="user-stats">
        <div class="stat-item">
            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="stat-value" id="balance">‚≠ê 2,500</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–ü–æ–±–µ–¥</div>
            <div class="stat-value" id="wins">47</div>
        </div>
        <div class="stat-item">
            <div class="stat-label">–í–∏–Ω—Ä–µ–π—Ç</div>
            <div class="stat-value" id="winrate">68%</div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è —Ä—É–ª–µ—Ç–∫–∏ -->
    <div class="roulette-section">
        <div class="wheel-container">
            <div class="arrow"></div>
            <div class="wheel" id="wheel"></div>
            <div class="center-timer">
                <span class="timer-value" id="timer">2:30</span>
                <span class="timer-label">–æ—Å—Ç–∞–ª–æ—Å—å</span>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—É–Ω–¥–µ -->
        <div class="round-info">
            <div class="players-count">
                <span class="players-icon">üë•</span>
                <span class="players-text" id="playersCount">3/10 –∏–≥—Ä–æ–∫–æ–≤</span>
            </div>
            <div class="pool-amount" id="poolAmount">‚≠ê 45</div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ -->
        <div class="players-list">
            <div class="players-title">
                <span>‚öîÔ∏è</span> –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ä–∞—É–Ω–¥–∞
            </div>
            <div id="playersContainer">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫–∏ -->
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ -->
        <div class="bet-panel">
            <div class="gifts-selector" id="giftsSelector">
                <!-- –ü–æ–¥–∞—Ä–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" id="joinRoundBtn">üéÅ –í–æ–π—Ç–∏ –≤ —Ä–∞—É–Ω–¥</button>
                <button class="btn btn-secondary" id="createPrivateBtn">üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π</button>
            </div>
            <button class="btn btn-success" id="quickBetBtn" style="margin-top: 10px;">‚ö° –ë—ã—Å—Ç—Ä–∞—è —Å—Ç–∞–≤–∫–∞ (‚≠ê10)</button>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
        <button class="nav-item active" data-tab="pvp">
            <span class="nav-icon">‚öîÔ∏è</span>
            <span class="nav-label">PvP</span>
        </button>
        <button class="nav-item" data-tab="solo">
            <span class="nav-icon">üéÆ</span>
            <span class="nav-label">–°–æ–ª–æ</span>
        </button>
        <button class="nav-item" data-tab="shop">
            <span class="nav-icon">üõí</span>
            <span class="nav-label">–ú–∞–≥–∞–∑–∏–Ω</span>
        </button>
        <button class="nav-item" data-tab="profile">
            <span class="nav-icon">üë§</span>
            <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è -->
    <div class="modal" id="winnerModal">
        <div class="modal-content">
            <div class="winner-emoji" id="winnerEmoji">üèÜ</div>
            <div class="winner-title" id="winnerName">–í—ã –ø–æ–±–µ–¥–∏–ª–∏!</div>
            <div class="winner-prize" id="winnerPrize">‚≠ê 45</div>
            <button class="modal-btn" onclick="closeModal()">–û—Ç–ª–∏—á–Ω–æ!</button>
        </div>
    </div>

    <script>
        // ========== –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ ==========
        let balance = 2500;
        let wins = 47;
        let totalGames = 69;
        
        // –î–∞–Ω–Ω—ã–µ —Ä–∞—É–Ω–¥–∞
        let roundPlayers = [
            { id: 1, name: '–í—ã', avatar: 'üòé', bet: 15, chance: 33.3 },
            { id: 2, name: 'CryptoKing', avatar: 'üëë', bet: 20, chance: 44.4 },
            { id: 3, name: 'LuckyOne', avatar: 'üçÄ', bet: 10, chance: 22.3 }
        ];
        
        let timerMinutes = 2;
        let timerSeconds = 30;
        let timerInterval = null;
        let wheelSpinning = false;
        let currentRotation = 0;
        let selectedGift = 10; // –í—ã–±—Ä–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞

        // –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏ [citation:2]
        const gifts = [
            { value: 1, emoji: '‚≠ê', label: 'Star', color: '#ffd700' },
            { value: 5, emoji: 'üåü', label: 'Super', color: '#ffaa00' },
            { value: 10, emoji: 'üí´', label: 'Mega', color: '#ff7700' },
            { value: 25, emoji: '‚ú®', label: 'Ultra', color: '#ff44aa' },
            { value: 50, emoji: 'üëë', label: 'Royal', color: '#aa44ff' }
        ];

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            updateUI();
            renderGifts();
            renderPlayers();
            startTimer();
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
            const user = tg.initDataUnsafe?.user;
            if (user) {
                roundPlayers[0].name = user.first_name || '–í—ã';
            }
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ==========
        function updateUI() {
            document.getElementById('balance').textContent = `‚≠ê ${balance}`;
            document.getElementById('wins').textContent = wins;
            document.getElementById('winrate').textContent = Math.round((wins / totalGames) * 100) + '%';
            document.getElementById('playersCount').textContent = `${roundPlayers.length}/10 –∏–≥—Ä–æ–∫–æ–≤`;
            
            // –°—É–º–º–∞ –ø—É–ª–∞ [citation:2]
            const totalPool = roundPlayers.reduce((sum, p) => sum + p.bet, 0);
            document.getElementById('poolAmount').textContent = `‚≠ê ${totalPool}`;
        }

        // ========== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ü–û–î–ê–†–ö–û–í ==========
        function renderGifts() {
            const container = document.getElementById('giftsSelector');
            container.innerHTML = '';
            
            gifts.forEach(gift => {
                const card = document.createElement('div');
                card.className = `gift-card ${gift.value === selectedGift ? 'selected' : ''}`;
                card.onclick = () => {
                    selectedGift = gift.value;
                    document.querySelectorAll('.gift-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                };
                
                card.innerHTML = `
                    <div class="gift-emoji">${gift.emoji}</div>
                    <div class="gift-value">‚≠ê${gift.value}</div>
                    <div class="gift-label">${gift.label}</div>
                `;
                container.appendChild(card);
            });
        }

        // ========== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ò–ì–†–û–ö–û–í ==========
        function renderPlayers() {
            const container = document.getElementById('playersContainer');
            container.innerHTML = '';
            
            roundPlayers.sort((a, b) => b.bet - a.bet).forEach(player => {
                const playerEl = document.createElement('div');
                playerEl.className = 'player-item';
                
                // –®–∞–Ω—Å –ø–æ–±–µ–¥—ã –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —Å—Ç–∞–≤–∫–µ [citation:2]
                const total = roundPlayers.reduce((sum, p) => sum + p.bet, 0);
                const chance = ((player.bet / total) * 100).toFixed(1);
                
                playerEl.innerHTML = `
                    <div class="player-info">
                        <div class="player-avatar">${player.avatar}</div>
                        <div>
                            <div class="player-name">${player.name}</div>
                            <div class="win-chance">üéØ —à–∞–Ω—Å ${chance}%</div>
                        </div>
                    </div>
                    <div class="player-bet">‚≠ê${player.bet}</div>
                `;
                container.appendChild(playerEl);
            });
        }

        // ========== –¢–ê–ô–ú–ï–† –†–ê–£–ù–î–ê (3 –º–∏–Ω—É—Ç—ã) [citation:2] ==========
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                if (timerSeconds <= 0) {
                    if (timerMinutes <= 0) {
                        // –í—Ä–µ–º—è –≤—ã—à–ª–æ - –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à
                        clearInterval(timerInterval);
                        spinWheel();
                        return;
                    } else {
                        timerMinutes--;
                        timerSeconds = 59;
                    }
                } else {
                    timerSeconds--;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                const timeStr = `${timerMinutes}:${timerSeconds.toString().padStart(2, '0')}`;
                document.getElementById('timer').textContent = timeStr;
                
                // –ú–∏–≥–∞–Ω–∏–µ –ø—Ä–∏ –æ—Å—Ç–∞—Ç–∫–µ 30 —Å–µ–∫
                if (timerMinutes === 0 && timerSeconds <= 30) {
                    document.getElementById('timer').style.color = '#ff4444';
                }
            }, 1000);
        }

        // ========== –í–†–ê–©–ï–ù–ò–ï –ö–û–õ–ï–°–ê ==========
        function spinWheel() {
            if (wheelSpinning || roundPlayers.length < 2) {
                // –ï—Å–ª–∏ –º–µ–Ω—å—à–µ 2 –∏–≥—Ä–æ–∫–æ–≤ - –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥ [citation:2]
                resetRound();
                return;
            }
            
            wheelSpinning = true;
            
            // –†–∞–Ω–¥–æ–º–Ω—ã–π —É–≥–æ–ª (5-8 –æ–±–æ—Ä–æ—Ç–æ–≤)
            const spins = 1800 + Math.random() * 1080;
            currentRotation += spins;
            
            const wheel = document.getElementById('wheel');
            wheel.style.transform = `rotate(${currentRotation}deg)`;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                // –í—ã–±–∏—Ä–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è —Å–ª—É—á–∞–π–Ω–æ, –Ω–æ —Å –≤–µ—Å–æ–º –æ—Ç —Å—Ç–∞–≤–æ–∫ [citation:2]
                const total = roundPlayers.reduce((sum, p) => sum + p.bet, 0);
                let random = Math.random() * total;
                let winner = null;
                
                for (let player of roundPlayers) {
                    if (random < player.bet) {
                        winner = player;
                        break;
                    }
                    random -= player.bet;
                }
                
                if (!winner) winner = roundPlayers[0];
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                showWinner(winner);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                if (winner.name === '–í—ã' || winner.id === 1) {
                    wins++;
                    balance += total;
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    resetRound();
                }, 3000);
                
            }, 4000);
        }

        // ========== –ü–û–ö–ê–ó –ü–û–ë–ï–î–ò–¢–ï–õ–Ø ==========
        function showWinner(winner) {
            const total = roundPlayers.reduce((sum, p) => sum + p.bet, 0);
            
            document.getElementById('winnerEmoji').textContent = winner.avatar;
            document.getElementById('winnerName').textContent = 
                winner.name === '–í—ã' ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : `–ü–æ–±–µ–¥–∏–ª ${winner.name}!`;
            document.getElementById('winnerPrize').textContent = `‚≠ê ${total}`;
            
            document.getElementById('winnerModal').classList.add('active');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–æ—Ç–∞
            tg.sendData(JSON.stringify({
                action: 'round_end',
                winner: winner.name,
                prize: total
            }));
        }

        // ========== –°–ë–†–û–° –†–ê–£–ù–î–ê ==========
        function resetRound() {
            timerMinutes = 2;
            timerSeconds = 30;
            wheelSpinning = false;
            
            // –ù–æ–≤—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ –∏–≥—Ä–æ–∫–∏
            roundPlayers = [
                { id: 1, name: '–í—ã', avatar: 'üòé', bet: 0 },
                { id: 2, name: 'Player_' + Math.floor(Math.random() * 1000), avatar: 'üéÆ', bet: Math.floor(Math.random() * 20) + 5 },
                { id: 3, name: 'Crypto_' + Math.floor(Math.random() * 100), avatar: 'üíé', bet: Math.floor(Math.random() * 30) + 10 }
            ];
            
            // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –±—ã–ª –≤ —Ä–∞—É–Ω–¥–µ, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ —Å—Ç–∞–≤–∫—É
            const playerBet = roundPlayers.find(p => p.id === 1).bet;
            if (playerBet === 0) {
                roundPlayers[0].bet = selectedGift;
            }
            
            updateUI();
            renderPlayers();
            startTimer();
            
            document.getElementById('timer').style.color = '#ffd700';
        }

        // ========== –î–ï–ô–°–¢–í–ò–Ø –ò–ì–†–û–ö–ê ==========
        document.getElementById('joinRoundBtn').addEventListener('click', () => {
            if (balance < selectedGift) {
                tg.showAlert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥! [citation:2]');
                return;
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–≥—Ä–æ–∫–∞ "–í—ã"
            const player = roundPlayers.find(p => p.id === 1);
            if (player) {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç–∞–≤–∫—É
                balance += player.bet;
                player.bet = selectedGift;
                balance -= selectedGift;
            }
            
            updateUI();
            renderPlayers();
            
            tg.HapticFeedback?.impactOccurred('medium');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞
            tg.sendData(JSON.stringify({
                action: 'join_round',
                bet: selectedGift
            }));
        });

        document.getElementById('quickBetBtn').addEventListener('click', () => {
            selectedGift = 10;
            document.getElementById('joinRoundBtn').click();
        });

        document.getElementById('createPrivateBtn').addEventListener('click', () => {
            tg.showPopup({
                title: '–ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–∞—É–Ω–¥',
                message: '–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—É—é –∏–≥—Ä—É –¥–ª—è –¥—Ä—É–∑–µ–π?',
                buttons: [
                    {id: 'create', type: 'default', text: '–°–æ–∑–¥–∞—Ç—å'},
                    {id: 'cancel', type: 'destructive', text: '–û—Ç–º–µ–Ω–∞'}
                ]
            }, (id) => {
                if (id === 'create') {
                    tg.showAlert('üîó –°—Å—ã–ª–∫–∞-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
                }
            });
        });

        // ========== –ù–ê–í–ò–ì–ê–¶–ò–Ø ==========
        document.querySelectorAll('.nav-item').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        // ========== –ú–û–î–ê–õ–ö–ê ==========
        window.closeModal = function() {
            document.getElementById('winnerModal').classList.remove('active');
        };

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
        document.getElementById('winnerModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('winnerModal')) {
                closeModal();
            }
        });

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
